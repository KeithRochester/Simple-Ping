<?xml version="1.0" encoding="utf-8"?>
<ManagementPack SchemaVersion="2.0" ContentReadable="true" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <Manifest>
    <Identity>
      <ID>Simple.Ping</ID>
      <Version>1.0.0.26</Version>
    </Identity>
    <Name>Simple Ping</Name>
    <References>
      <Reference Alias="MSDL">
        <ID>Microsoft.SystemCenter.DataWarehouse.Library</ID>
        <Version>7.1.10226.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="SC">
        <ID>Microsoft.SystemCenter.Library</ID>
        <Version>7.0.8433.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="Windows">
        <ID>Microsoft.Windows.Library</ID>
        <Version>7.5.8501.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="Health">
        <ID>System.Health.Library</ID>
        <Version>7.0.8433.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="System">
        <ID>System.Library</ID>
        <Version>7.5.8501.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
      <Reference Alias="Perf">
        <ID>System.Performance.Library</ID>
        <Version>7.0.8433.0</Version>
        <PublicKeyToken>31bf3856ad364e35</PublicKeyToken>
      </Reference>
    </References>
  </Manifest>
  <TypeDefinitions>
    <EntityTypes>
      <ClassTypes>
        <ClassType ID="Simple.Ping.Resource.Pool" Accessibility="Public" Abstract="false" Base="SC!Microsoft.SystemCenter.ManagementServicePool" Hosted="false" Singleton="true" />
        <ClassType ID="Simple.Ping.Target" Base="System!System.Entity" Accessibility="Public" Abstract="false" Hosted="false" Singleton="false">
          <Property ID="Address" Type="string" Key="true" />
          <Property ID="MatchCount" Type="int" Key="false" />
          <Property ID="FrequencySeconds" Type="int" Key="false" />
          <Property ID="ExpectedStatus" Type="string" Key="true" />
        </ClassType>
      </ClassTypes>
    </EntityTypes>
    <ModuleTypes>
      <DataSourceModuleType ID="Simple.Ping.ICMPPing.DataSource" Accessibility="Public" Batching="false">
        <Configuration>
          <xsd:element minOccurs="1" name="Frequency" type="xsd:integer" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="ScheduleStartTime" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="ScheduleEndTime" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="ScheduleDays" type="xsd:int" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="0" name="SyncTime" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="Watcher" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="Address" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="Frequency" Selector="$Config/Frequency$" ParameterType="int" />
          <OverrideableParameter ID="ScheduleStartTime" Selector="$Config/ScheduleStartTime$" ParameterType="string" />
          <OverrideableParameter ID="ScheduleEndTime" Selector="$Config/ScheduleEndTime$" ParameterType="string" />
          <OverrideableParameter ID="ScheduleDays" Selector="$Config/ScheduleDays$" ParameterType="int" />
          <OverrideableParameter ID="SyncTime" Selector="$Config/SyncTime$" ParameterType="string" />
          <OverrideableParameter ID="Watcher" Selector="$Config/Watcher$" ParameterType="string" />
          <OverrideableParameter ID="Address" Selector="$Config/Address$" ParameterType="string" />
        </OverrideableParameters>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <DataSource ID="SimpleScheduler" TypeID="System!System.SimpleScheduler">
                <IntervalSeconds>$Config/Frequency$</IntervalSeconds>
                <SyncTime>$Config/SyncTime$</SyncTime>
              </DataSource>
              <ProbeAction ID="Probe" TypeID="SC!Microsoft.SystemCenter.ICMPProbe">
                <ComputerSourcePing>$Config/Watcher$</ComputerSourcePing>
                <NetworkTargetToPing>$Config/Address$</NetworkTargetToPing>
              </ProbeAction>
              <ConditionDetection ID="SchedulerFilter" TypeID="System!System.SchedulerFilter">
                <SchedulerFilter>
                  <ProcessDataMode>OnSchedule</ProcessDataMode>
                  <Schedule>
                    <WeeklySchedule>
                      <Windows>
                        <Daily>
                          <Start>$Config/ScheduleStartTime$</Start>
                          <End>$Config/ScheduleEndTime$</End>
                          <DaysOfWeekMask>$Config/ScheduleDays$</DaysOfWeekMask>
                        </Daily>
                      </Windows>
                    </WeeklySchedule>
                    <ExcludeDates />
                  </Schedule>
                  <UseCurrentTime>true</UseCurrentTime>
                </SchedulerFilter>
              </ConditionDetection>
            </MemberModules>
            <Composition>
              <Node ID="Probe">
                <Node ID="SchedulerFilter">
                  <Node ID="SimpleScheduler" />
                </Node>
              </Node>
            </Composition>
          </Composite>
        </ModuleImplementation>
        <OutputType>System!System.PropertyBagData</OutputType>
      </DataSourceModuleType>
      <WriteActionModuleType ID="Simple.Ping.AddSimplePing.WriteAction" Accessibility="Public" Batching="false">
        <Configuration>
          <xsd:element minOccurs="1" name="DisplayName" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="Address" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="ExpectedStatus" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
            <xsd:simpleType>
              <xsd:restriction base="xsd:string">
                <xsd:enumeration value="UP" />
                <xsd:enumeration value="DOWN" />
              </xsd:restriction>
            </xsd:simpleType>
          </xsd:element>
          <xsd:element minOccurs="1" name="MatchCount" type="xsd:integer" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="FrequencySeconds" type="xsd:integer" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="ManagementServer" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="DisplayName" Selector="$Config/DisplayName$" ParameterType="string" />
          <OverrideableParameter ID="Address" Selector="$Config/Address$" ParameterType="string" />
          <OverrideableParameter ID="ExpectedStatus" Selector="$Config/ExpectedStatus$" ParameterType="string" />
          <OverrideableParameter ID="MatchCount" Selector="$Config/MatchCount$" ParameterType="int" />
          <OverrideableParameter ID="FrequencySeconds" Selector="$Config/FrequencySeconds$" ParameterType="int" />
          <OverrideableParameter ID="ManagementServer" Selector="$Config/ManagementServer$" ParameterType="string" />
        </OverrideableParameters>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <WriteAction ID="Script" TypeID="Windows!Microsoft.Windows.PowerShellWriteAction">
                <ScriptName>Create-SimplePing.ps1</ScriptName>
                <ScriptBody><![CDATA[[CmdletBinding()]
Param(
	[Parameter(Mandatory=$True)]
	[string]$DisplayName,
	[Parameter(Mandatory = $True)]
	[String]$Address,
	[Parameter(Mandatory = $True)]
    [ValidateSet("UP","DOWN")]
	[String]$ExpectedStatus,    
	[Parameter(Mandatory = $True)]
	[String]$MatchCount,
	[Parameter(Mandatory = $True)]
	[String]$FrequencySeconds,
	[Parameter(Mandatory = $false)]
	[String]$ManagementServer = '.'

)

<#
$DisplayName = "Testing"
$Address = '127.0.0.1'
$ExpectedStatus = "UP"
$MatchCount = 1
$FrequencySeconds = 300
$ManagementServer = '.'
#>

Add-PSSnapin Microsoft.EnterpriseManagement.OperationsManager.Client
New-SCOMManagementGroupConnection -ComputerName $ManagementServer
$MG = Get-SCOMManagementGroup


$EntityClass = Get-SCOMClass -Name System.Entity
$PingTargetClass = Get-SCOMClass -Name Simple.Ping.Target

$Connector = Get-SCOMConnector -DisplayName "Simple Ping Connector"
if(!$Connector){
    Add-SCOMConnector -Name "Simple Ping Connector" -DisplayName "Simple Ping Connector" -Description "Connector used to submit discovery data"
    $Connector = Get-SCOMConnector -DisplayName "Simple Ping Connector"
    }


$DiscoveryData = New-Object Microsoft.EnterpriseManagement.ConnectorFramework.IncrementalDiscoveryData

$PingTarget = New-Object Microsoft.EnterpriseManagement.Common.CreatableEnterpriseManagementObject($mg,$PingTargetClass)

$PingTarget[$PingTargetClass,"Address"].Value = $Address
$PingTarget[$PingTargetClass,"MatchCount"].Value = $MatchCount
$PingTarget[$PingTargetClass,"FrequencySeconds"].Value = $FrequencySeconds
$PingTarget[$PingTargetClass,"ExpectedStatus"].Value = $ExpectedStatus
$PingTarget[$EntityClass,"DisplayName"].Value = $DisplayName


$DiscoveryData.Add($PingTarget)
$DiscoveryData.Commit($Connector)]]></ScriptBody>
                <Parameters>
                  <Parameter>
                    <Name>DisplayName</Name>
                    <Value>$Config/DisplayName$</Value>
                  </Parameter>
                  <Parameter>
                    <Name>Address</Name>
                    <Value>$Config/Address$</Value>
                  </Parameter>
                  <Parameter>
                    <Name>ExpectedStatus</Name>
                    <Value>$Config/ExpectedStatus$</Value>
                  </Parameter>
                  <Parameter>
                    <Name>MatchCount</Name>
                    <Value>$Config/MatchCount$</Value>
                  </Parameter>
                  <Parameter>
                    <Name>FrequencySeconds</Name>
                    <Value>$Config/FrequencySeconds$</Value>
                  </Parameter>
                  <Parameter>
                    <Name>ManagementServer</Name>
                    <Value>$Config/ManagementServer$</Value>
                  </Parameter>
                </Parameters>
                <TimeoutSeconds>300</TimeoutSeconds>
              </WriteAction>
            </MemberModules>
            <Composition>
              <Node ID="Script" />
            </Composition>
          </Composite>
        </ModuleImplementation>
        <OutputType>Windows!Microsoft.Windows.SerializedObjectData</OutputType>
        <InputType>System!System.BaseData</InputType>
      </WriteActionModuleType>
      <WriteActionModuleType ID="Simple.Ping.RemoveSimplePing.WriteAction" Accessibility="Public" Batching="false">
        <Configuration>
          <xsd:element minOccurs="1" name="DisplayName" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="Address" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="ExpectedStatus" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="1" name="ManagementServer" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="ManagementServer" Selector="$Config/ManagementServer$" ParameterType="string" />
        </OverrideableParameters>
        <ModuleImplementation Isolation="Any">
          <Composite>
            <MemberModules>
              <WriteAction ID="Script" TypeID="Windows!Microsoft.Windows.PowerShellWriteAction">
                <ScriptName>Remove-SimplePing.ps1</ScriptName>
                <ScriptBody><![CDATA[[CmdletBinding()]
Param(
	[Parameter(Mandatory=$True)]
	[string]$DisplayName,
	[Parameter(Mandatory = $True)]
	[String]$Address,
	[Parameter(Mandatory = $True)]
    [ValidateSet("UP","DOWN")]
	[String]$ExpectedStatus,    
	[Parameter(Mandatory = $false)]
	[String]$ManagementServer = '.'

)

<#
$DisplayName = "Testing"
$Address = '127.0.0.1'
$ExpectedStatus = "UP"
$MatchCount = 1
$FrequencySeconds = 300
$ManagementServer = '.'
#>

Add-PSSnapin Microsoft.EnterpriseManagement.OperationsManager.Client
New-SCOMManagementGroupConnection -ComputerName $ManagementServer
$MG = Get-SCOMManagementGroup


$EntityClass = Get-SCOMClass -Name System.Entity
$PingTargetClass = Get-SCOMClass -Name Simple.Ping.Target

$Connector = Get-SCOMConnector -DisplayName "Simple Ping Connector"
if(!$Connector){
    Add-SCOMConnector -Name "Simple Ping Connector" -DisplayName "Simple Ping Connector" -Description "Connector used to submit discovery data"
    $Connector = Get-SCOMConnector -DisplayName "Simple Ping Connector"
    }


$DiscoveryData = New-Object Microsoft.EnterpriseManagement.ConnectorFramework.IncrementalDiscoveryData

$PingTarget = New-Object Microsoft.EnterpriseManagement.Common.CreatableEnterpriseManagementObject($mg,$PingTargetClass)

$PingTarget[$PingTargetClass,"Address"].Value = $Address
$PingTarget[$PingTargetClass,"ExpectedStatus"].Value = $ExpectedStatus
$PingTarget[$EntityClass,"DisplayName"].Value = $DisplayName

$DiscoveryData.Remove($PingTarget)
$DiscoveryData.Commit($Connector)]]></ScriptBody>
                <Parameters>
                  <Parameter>
                    <Name>DisplayName</Name>
                    <Value>$Config/DisplayName$</Value>
                  </Parameter>
                  <Parameter>
                    <Name>Address</Name>
                    <Value>$Config/Address$</Value>
                  </Parameter>
                  <Parameter>
                    <Name>ExpectedStatus</Name>
                    <Value>$Config/ExpectedStatus$</Value>
                  </Parameter>
                  <Parameter>
                    <Name>ManagementServer</Name>
                    <Value>$Config/ManagementServer$</Value>
                  </Parameter>
                </Parameters>
                <TimeoutSeconds>300</TimeoutSeconds>
              </WriteAction>
            </MemberModules>
            <Composition>
              <Node ID="Script" />
            </Composition>
          </Composite>
        </ModuleImplementation>
        <OutputType>Windows!Microsoft.Windows.SerializedObjectData</OutputType>
        <InputType>System!System.BaseData</InputType>
      </WriteActionModuleType>
    </ModuleTypes>
    <MonitorTypes>
      <UnitMonitorType ID="Simple.Ping.ICMPPing.MonitorType" Accessibility="Public">
        <MonitorTypeStates>
          <MonitorTypeState ID="Healthy" NoDetection="false" />
          <MonitorTypeState ID="Warning" NoDetection="false" />
          <MonitorTypeState ID="Critical" NoDetection="false" />
        </MonitorTypeStates>
        <Configuration>
          <xsd:element name="Watcher" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element name="Address" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element name="ExpectedStatus" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element name="ScheduleStartTime" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element name="ScheduleEndTime" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element name="ScheduleDays" type="xsd:int" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element name="MatchCount" type="xsd:int" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element name="Frequency" type="xsd:int" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element name="Severity" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
          <xsd:element minOccurs="0" name="SyncTime" type="xsd:string" xmlns:xsd="http://www.w3.org/2001/XMLSchema" />
        </Configuration>
        <OverrideableParameters>
          <OverrideableParameter ID="ExpectedStatus" Selector="$Config/ExpectedStatus$" ParameterType="string" />
          <OverrideableParameter ID="SyncTime" Selector="$Config/SyncTime$" ParameterType="string" />
          <OverrideableParameter ID="ScheduleStartTime" Selector="$Config/ScheduleStartTime$" ParameterType="string" />
          <OverrideableParameter ID="ScheduleEndTime" Selector="$Config/ScheduleEndTime$" ParameterType="string" />
          <OverrideableParameter ID="ScheduleDays" Selector="$Config/ScheduleDays$" ParameterType="int" />
          <OverrideableParameter ID="Frequency" Selector="$Config/Frequency$" ParameterType="int" />
          <OverrideableParameter ID="MatchCount" Selector="$Config/MatchCount$" ParameterType="int" />
          <OverrideableParameter ID="Severity" Selector="$Config/Severity$" ParameterType="string" />
        </OverrideableParameters>
        <MonitorImplementation>
          <MemberModules>
            <DataSource ID="DS" TypeID="Simple.Ping.ICMPPing.DataSource">
              <Frequency>$Config/Frequency$</Frequency>
              <ScheduleStartTime>$Config/ScheduleStartTime$</ScheduleStartTime>
              <ScheduleEndTime>$Config/ScheduleEndTime$</ScheduleEndTime>
              <ScheduleDays>$Config/ScheduleDays$</ScheduleDays>
              <SyncTime>$Config/SyncTime$</SyncTime>
              <Watcher>$Config/Watcher$</Watcher>
              <Address>$Config/Address$</Address>
            </DataSource>
            <ConditionDetection ID="PingUnhealthy" TypeID="System!System.ExpressionFilter">
              <Expression>
                <Or>
                  <Expression>
                    <And>
                      <Expression>
                        <SimpleExpression>
                          <ValueExpression>
                            <Value Type="String">$Config/ExpectedStatus$</Value>
                          </ValueExpression>
                          <Operator>Equal</Operator>
                          <ValueExpression>
                            <Value Type="String">DOWN</Value>
                          </ValueExpression>
                        </SimpleExpression>
                      </Expression>
                      <Expression>
                        <SimpleExpression>
                          <ValueExpression>
                            <XPathQuery>Property[@Name='StatusCode']</XPathQuery>
                          </ValueExpression>
                          <Operator>Equal</Operator>
                          <ValueExpression>
                            <Value Type="UnsignedInteger">0</Value>
                          </ValueExpression>
                        </SimpleExpression>
                      </Expression>
                    </And>
                  </Expression>
                  <Expression>
                    <And>
                      <Expression>
                        <SimpleExpression>
                          <ValueExpression>
                            <Value Type="String">$Config/ExpectedStatus$</Value>
                          </ValueExpression>
                          <Operator>Equal</Operator>
                          <ValueExpression>
                            <Value Type="String">UP</Value>
                          </ValueExpression>
                        </SimpleExpression>
                      </Expression>
                      <Expression>
                        <Or>
                          <Expression>
                            <Not>
                              <Expression>
                                <Exists>
                                  <ValueExpression>
                                    <XPathQuery>Property[@Name='StatusCode']</XPathQuery>
                                  </ValueExpression>
                                </Exists>
                              </Expression>
                            </Not>
                          </Expression>
                          <Expression>
                            <SimpleExpression>
                              <ValueExpression>
                                <XPathQuery>Property[@Name='StatusCode']</XPathQuery>
                              </ValueExpression>
                              <Operator>NotEqual</Operator>
                              <ValueExpression>
                                <Value Type="UnsignedInteger">0</Value>
                              </ValueExpression>
                            </SimpleExpression>
                          </Expression>
                        </Or>
                      </Expression>
                    </And>
                  </Expression>
                </Or>
              </Expression>
              <SuppressionSettings>
                <MatchCount>$Config/MatchCount$</MatchCount>
              </SuppressionSettings>
            </ConditionDetection>
            <ConditionDetection ID="PingHealthy" TypeID="System!System.ExpressionFilter">
              <Expression>
                <Or>
                  <Expression>
                    <And>
                      <Expression>
                        <SimpleExpression>
                          <ValueExpression>
                            <Value Type="String">$Config/ExpectedStatus$</Value>
                          </ValueExpression>
                          <Operator>Equal</Operator>
                          <ValueExpression>
                            <Value Type="String">UP</Value>
                          </ValueExpression>
                        </SimpleExpression>
                      </Expression>
                      <Expression>
                        <SimpleExpression>
                          <ValueExpression>
                            <XPathQuery>Property[@Name='StatusCode']</XPathQuery>
                          </ValueExpression>
                          <Operator>Equal</Operator>
                          <ValueExpression>
                            <Value Type="UnsignedInteger">0</Value>
                          </ValueExpression>
                        </SimpleExpression>
                      </Expression>
                    </And>
                  </Expression>
                  <Expression>
                    <And>
                      <Expression>
                        <SimpleExpression>
                          <ValueExpression>
                            <Value Type="String">$Config/ExpectedStatus$</Value>
                          </ValueExpression>
                          <Operator>Equal</Operator>
                          <ValueExpression>
                            <Value Type="String">DOWN</Value>
                          </ValueExpression>
                        </SimpleExpression>
                      </Expression>
                      <Expression>
                        <Or>
                          <Expression>
                            <Not>
                              <Expression>
                                <Exists>
                                  <ValueExpression>
                                    <XPathQuery>Property[@Name='StatusCode']</XPathQuery>
                                  </ValueExpression>
                                </Exists>
                              </Expression>
                            </Not>
                          </Expression>
                          <Expression>
                            <SimpleExpression>
                              <ValueExpression>
                                <XPathQuery>Property[@Name='StatusCode']</XPathQuery>
                              </ValueExpression>
                              <Operator>NotEqual</Operator>
                              <ValueExpression>
                                <Value Type="UnsignedInteger">0</Value>
                              </ValueExpression>
                            </SimpleExpression>
                          </Expression>
                        </Or>
                      </Expression>
                    </And>
                  </Expression>
                </Or>
              </Expression>
              <SuppressionSettings>
                <MatchCount>$Config/MatchCount$</MatchCount>
              </SuppressionSettings>
            </ConditionDetection>
            <ConditionDetection ID="CDCritical" TypeID="System!System.ExpressionFilter">
              <Expression>
                <SimpleExpression>
                  <ValueExpression>
                    <Value Type="String">$Config/Severity$</Value>
                  </ValueExpression>
                  <Operator>Equal</Operator>
                  <ValueExpression>
                    <Value Type="String">Critical</Value>
                  </ValueExpression>
                </SimpleExpression>
              </Expression>
            </ConditionDetection>
            <ConditionDetection ID="CDWarning" TypeID="System!System.ExpressionFilter">
              <Expression>
                <SimpleExpression>
                  <ValueExpression>
                    <Value Type="String">$Config/Severity$</Value>
                  </ValueExpression>
                  <Operator>Equal</Operator>
                  <ValueExpression>
                    <Value Type="String">Warning</Value>
                  </ValueExpression>
                </SimpleExpression>
              </Expression>
            </ConditionDetection>
          </MemberModules>
          <RegularDetections>
            <RegularDetection MonitorTypeStateID="Healthy">
              <Node ID="PingHealthy">
                <Node ID="DS" />
              </Node>
            </RegularDetection>
            <RegularDetection MonitorTypeStateID="Critical">
              <Node ID="CDCritical">
                <Node ID="PingUnhealthy">
                  <Node ID="DS" />
                </Node>
              </Node>
            </RegularDetection>
            <RegularDetection MonitorTypeStateID="Warning">
              <Node ID="CDWarning">
                <Node ID="PingUnhealthy">
                  <Node ID="DS" />
                </Node>
              </Node>
            </RegularDetection>
          </RegularDetections>
        </MonitorImplementation>
      </UnitMonitorType>
    </MonitorTypes>
  </TypeDefinitions>
  <Monitoring>
    <Discoveries>
      <Discovery ID="Simple.Ping.Resource.Pool.Discovery" Target="Simple.Ping.Resource.Pool" Enabled="true" Remotable="true" Priority="Normal">
        <Category>Discovery</Category>
        <DiscoveryTypes>
          <DiscoveryRelationship TypeID="SC!Microsoft.SystemCenter.ManagementActionPointShouldManageEntity" />
        </DiscoveryTypes>
        <DataSource ID="DS" TypeID="SC!Microsoft.SystemCenter.GroupPopulator">
          <RuleId>$MPElement$</RuleId>
          <GroupInstanceId>$Target/Id$</GroupInstanceId>
          <MembershipRules>
            <MembershipRule>
              <MonitoringClass>$MPElement[Name="Simple.Ping.Target"]$</MonitoringClass>
              <RelationshipClass>$MPElement[Name="SC!Microsoft.SystemCenter.ManagementActionPointShouldManageEntity"]$</RelationshipClass>
            </MembershipRule>
          </MembershipRules>
        </DataSource>
      </Discovery>
    </Discoveries>
    <Rules>
      <Rule ID="Simple.Ping.Target.ResponseTimePerformanceCollection.Rule" Enabled="true" Target="Simple.Ping.Target" ConfirmDelivery="false" Remotable="true" Priority="Normal" DiscardLevel="100">
        <Category>PerformanceCollection</Category>
        <DataSources>
          <DataSource ID="DS" TypeID="Simple.Ping.ICMPPing.DataSource">
            <Frequency>$Target/Property[Type="Simple.Ping.Target"]/FrequencySeconds$</Frequency>
            <ScheduleStartTime>00:00</ScheduleStartTime>
            <ScheduleEndTime>23:59</ScheduleEndTime>
            <ScheduleDays>127</ScheduleDays>
            <SyncTime />
            <Watcher>.</Watcher>
            <Address>$Target/Property[Type="Simple.Ping.Target"]/Address$</Address>
          </DataSource>
        </DataSources>
        <ConditionDetection ID="PerfMapper" TypeID="Perf!System.Performance.DataGenericMapper">
          <ObjectName>Ping</ObjectName>
          <CounterName>Response Time (ms)</CounterName>
          <InstanceName>$Target/Property[Type="Simple.Ping.Target"]/Address$</InstanceName>
          <Value>$Data/Property[@Name='ResponseTime']$</Value>
        </ConditionDetection>
        <WriteActions>
          <WriteAction ID="PerfWriteAction" TypeID="SC!Microsoft.SystemCenter.CollectPerformanceData" />
          <WriteAction ID="PerfWriteToDWAction" TypeID="MSDL!Microsoft.SystemCenter.DataWarehouse.PublishPerformanceData" />
        </WriteActions>
      </Rule>
    </Rules>
    <Tasks>
      <Task ID="Simple.Ping.RemoveSimplePing.Task" Accessibility="Internal" Target="Simple.Ping.Target" Enabled="true" Timeout="300" Remotable="true">
        <Category>Maintenance</Category>
        <WriteAction ID="WA" TypeID="Simple.Ping.RemoveSimplePing.WriteAction">
          <DisplayName>$Target/Property[Type="System!System.Entity"]/DisplayName$</DisplayName>
          <Address>$Target/Property[Type="Simple.Ping.Target"]/Address$</Address>
          <ExpectedStatus>$Target/Property[Type="Simple.Ping.Target"]/ExpectedStatus$</ExpectedStatus>
          <ManagementServer>.</ManagementServer>
        </WriteAction>
      </Task>
      <Task ID="Simple.Ping.AddSimplePing.Task" Accessibility="Internal" Target="Simple.Ping.Resource.Pool" Enabled="true" Timeout="300" Remotable="true">
        <Category>Maintenance</Category>
        <WriteAction ID="WA" TypeID="Simple.Ping.AddSimplePing.WriteAction">
          <DisplayName>ENTER DISPLAY NAME</DisplayName>
          <Address>ENTER ADDRESS</Address>
          <ExpectedStatus>UP</ExpectedStatus>
          <MatchCount>1</MatchCount>
          <FrequencySeconds>300</FrequencySeconds>
          <ManagementServer>.</ManagementServer>
        </WriteAction>
      </Task>
    </Tasks>
    <Monitors>
      <UnitMonitor ID="Simple.Ping.PingStatus.Monitor" Accessibility="Internal" Enabled="true" Target="Simple.Ping.Target" ParentMonitorID="Health!System.Health.AvailabilityState" Remotable="true" Priority="Normal" TypeID="Simple.Ping.ICMPPing.MonitorType" ConfirmDelivery="false">
        <Category>AvailabilityHealth</Category>
        <AlertSettings AlertMessage="Simple.Ping.PingStatus.Monitor.AlertMessage">
          <AlertOnState>Warning</AlertOnState>
          <AutoResolve>true</AutoResolve>
          <AlertPriority>Normal</AlertPriority>
          <AlertSeverity>MatchMonitorHealth</AlertSeverity>
          <AlertParameters>
            <AlertParameter1>$Target/Property[Type="System!System.Entity"]/DisplayName$</AlertParameter1>
            <AlertParameter2>$Target/Property[Type="Simple.Ping.Target"]/Address$</AlertParameter2>
            <AlertParameter3>$Target/Property[Type="Simple.Ping.Target"]/ExpectedStatus$</AlertParameter3>
          </AlertParameters>
        </AlertSettings>
        <OperationalStates>
          <OperationalState ID="Healthy" MonitorTypeStateID="Healthy" HealthState="Success" />
          <OperationalState ID="Warning" MonitorTypeStateID="Warning" HealthState="Warning" />
          <OperationalState ID="Critical" MonitorTypeStateID="Critical" HealthState="Error" />
        </OperationalStates>
        <Configuration>
          <Watcher>.</Watcher>
          <Address>$Target/Property[Type="Simple.Ping.Target"]/Address$</Address>
          <ExpectedStatus>$Target/Property[Type="Simple.Ping.Target"]/ExpectedStatus$</ExpectedStatus>
          <ScheduleStartTime>00:00</ScheduleStartTime>
          <ScheduleEndTime>23:59</ScheduleEndTime>
          <ScheduleDays>127</ScheduleDays>
          <MatchCount>1</MatchCount>
          <Frequency>300</Frequency>
          <Severity>Critical</Severity>
          <SyncTime></SyncTime>
        </Configuration>
      </UnitMonitor>
    </Monitors>
  </Monitoring>
  <Presentation>
    <Views>
      <View ID="Simple.Ping.Resource.Pool.View" Accessibility="Public" Enabled="true" Target="Simple.Ping.Resource.Pool" TypeID="SC!Microsoft.SystemCenter.StateViewType" Visible="true">
        <Category>Operations</Category>
        <Criteria>
          <InMaintenanceMode>false</InMaintenanceMode>
        </Criteria>
        <Presentation>
          <ColumnInfo Index="0" SortIndex="0" Width="100" Grouped="false" Sorted="true" IsSortable="true" Visible="true" SortOrder="Descending">
            <Name>State</Name>
            <Id>Simple.Ping.Resource.Pool</Id>
          </ColumnInfo>
          <ColumnInfo Index="1" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Maintenance Mode</Name>
            <Id>InMaintenanceMode</Id>
          </ColumnInfo>
          <ColumnInfo Index="2" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Name</Name>
            <Id>Name</Id>
          </ColumnInfo>
        </Presentation>
        <Target />
      </View>
      <View ID="Simple.Ping.Target.View" Accessibility="Public" Enabled="true" Target="Simple.Ping.Target" TypeID="SC!Microsoft.SystemCenter.StateViewType" Visible="true">
        <Category>Operations</Category>
        <Criteria>
          <InMaintenanceMode>false</InMaintenanceMode>
        </Criteria>
        <Presentation>
          <ColumnInfo Index="0" SortIndex="0" Width="100" Grouped="false" Sorted="true" IsSortable="true" Visible="true" SortOrder="Descending">
            <Name>State</Name>
            <Id>Simple.Ping.Target</Id>
          </ColumnInfo>
          <ColumnInfo Index="1" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Maintenance Mode</Name>
            <Id>InMaintenanceMode</Id>
          </ColumnInfo>
          <ColumnInfo Index="2" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Name</Name>
            <Id>Name</Id>
          </ColumnInfo>
          <ColumnInfo Index="3" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Address</Name>
            <Id>Simple.Ping.Target/Address</Id>
          </ColumnInfo>
          <ColumnInfo Index="4" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Expected Status</Name>
            <Id>Simple.Ping.Target/ExpectedStatus</Id>
          </ColumnInfo>
          <ColumnInfo Index="5" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Frequency (Seconds)</Name>
            <Id>Simple.Ping.Target/FrequencySeconds</Id>
          </ColumnInfo>
          <ColumnInfo Index="5" SortIndex="-1" Width="100" Grouped="false" Sorted="false" IsSortable="true" Visible="true" SortOrder="Ascending">
            <Name>Match Count</Name>
            <Id>Simple.Ping.Target/MatchCount</Id>
          </ColumnInfo>
        </Presentation>
        <Target />
      </View>
    </Views>
    <Folders>
      <Folder ID="Simple.Ping.Root.Folder" Accessibility="Public" ParentFolder="SC!Microsoft.SystemCenter.Monitoring.ViewFolder.Root" />
    </Folders>
    <FolderItems>
      <FolderItem ElementID="Simple.Ping.Resource.Pool.View" ID="Simple.Ping.Resource.Pool.View.FolderItem" Folder="Simple.Ping.Root.Folder" />
      <FolderItem ElementID="Simple.Ping.Target.View" ID="Simple.Ping.Target.View.FolderItem" Folder="Simple.Ping.Root.Folder" />
    </FolderItems>
    <StringResources>
      <StringResource ID="Simple.Ping.PingStatus.Monitor.AlertMessage" />
    </StringResources>
  </Presentation>
  <LanguagePacks>
    <LanguagePack ID="ENU" IsDefault="true">
      <DisplayStrings>
        <DisplayString ElementID="Simple.Ping.AddSimplePing.WriteAction">
          <Name>Add Simple Ping</Name>
          <Description>Created Simple Ping</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.AddSimplePing.WriteAction" SubElementID="DisplayName">
          <Name>Display Name</Name>
          <Description>Display Name for the ping monitor.</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.AddSimplePing.WriteAction" SubElementID="Address">
          <Name>Address</Name>
          <Description>Address to Ping</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.AddSimplePing.WriteAction" SubElementID="ExpectedStatus">
          <Name>Expected Status</Name>
          <Description>Expected status Up or Down.</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.AddSimplePing.WriteAction" SubElementID="MatchCount">
          <Name>Match Count</Name>
          <Description>Number of consecutive samples before state changes.</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.AddSimplePing.WriteAction" SubElementID="FrequencySeconds">
          <Name>Frequency Seconds</Name>
          <Description>Frequency in seconds.</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.AddSimplePing.WriteAction" SubElementID="ManagementServer">
          <Name>Management Server</Name>
          <Description>Management Server to run the task on.</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.RemoveSimplePing.Task">
          <Name>Remove Simple Ping</Name>
          <Description>Remove Simple Ping</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.AddSimplePing.Task">
          <Name>Add Simple Ping</Name>
          <Description>Add Simple Ping</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.Resource.Pool">
          <Name>Simple Ping Monitoring Resource Pool</Name>
          <Description>Resource Pool used to run Simple Ping Monitoring</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.Target">
          <Name>Simple Ping Target</Name>
          <Description>Target to be pinged</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.Target" SubElementID="Address">
          <Name>Address</Name>
          <Description>Address to Ping</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.Target" SubElementID="ExpectedStatus">
          <Name>Expected Status</Name>
          <Description>Expected status Up or Down.</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.Target" SubElementID="MatchCount">
          <Name>Match Count</Name>
          <Description>Number of consecutive samples before state changes.</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.Target" SubElementID="FrequencySeconds">
          <Name>Frequency Seconds</Name>
          <Description>Frequency in seconds.</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.ICMPPing.DataSource">
          <Name>Simple Ping ICMP Ping Data Source</Name>
          <Description>Pings the address on a simple schedule</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.ICMPPing.DataSource" SubElementID="Address">
          <Name>Address</Name>
          <Description>Address (IP address or FQDN) to be tested</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.ICMPPing.DataSource" SubElementID="Watcher">
          <Name>Watcher</Name>
          <Description>Watcher location to ping from</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.ICMPPing.DataSource" SubElementID="Frequency">
          <Name>Frequency</Name>
          <Description>Frequency monitoring will run</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.ICMPPing.DataSource" SubElementID="ScheduleDays">
          <Name>ScheduleDays (Bit Mask)</Name>
          <Description>
            Bit mask for the days of the week that monitoring should run.

            Sunday = 1
            Monday = 2
            Tuesday = 4
            Wednesday = 8
            Thursday = 16
            Friday = 32
            Saturday = 64

            Sunday to Saturday  = 127
            Monday to Friday = 62
          </Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.ICMPPing.DataSource" SubElementID="ScheduleStartTime">
          <Name>Schedule Start Time</Name>
          <Description>Time of day that monitoring will run from e.g. 00:00, 08:00, etc...</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.ICMPPing.DataSource" SubElementID="ScheduleEndTime">
          <Name>Schedule End Time</Name>
          <Description>Time of day that monitoring will stop running e.g. 23:59, 17:00, etc...</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.ICMPPing.DataSource" SubElementID="SyncTime">
          <Name>Sync Time</Name>
          <Description>Sync Time</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping">
          <Name>Simple Ping</Name>
          <Description>Simple Ping</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.ICMPPing.MonitorType">
          <Name>SMF: Windows Ping Monitor Type</Name>
          <Description>Pings the target address and alerts if unable</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.ICMPPing.MonitorType" SubElementID="Frequency">
          <Name>Frequency</Name>
          <Description>Frequency in seconds that the monitoring will run</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.ICMPPing.MonitorType" SubElementID="ScheduleDays">
          <Name>Schedule Days</Name>
          <Description>
            Bit mask for the days of the week that monitoring should run

            Sunday = 1
            Monday = 2
            Tuesday = 4
            Wednesday = 8
            Thursday = 16
            Friday = 32
            Saturday = 64

            Sunday to Saturday  = 127
            Monday to Friday = 62.
          </Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.ICMPPing.MonitorType" SubElementID="ScheduleStartTime">
          <Name>Schedule Start Time</Name>
          <Description>Time of day that monitoring will run from e.g. 00:00, 08:00, etc...</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.ICMPPing.MonitorType" SubElementID="ScheduleEndTime">
          <Name>Schedule End Time</Name>
          <Description>Time of day that monitoring will stop running e.g. 23:59, 17:00, etc...</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.ICMPPing.MonitorType" SubElementID="Severity">
          <Name>Severity</Name>
          <Description>Severity or alerts and state on dashboards. Critical or Warning</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.ICMPPing.MonitorType" SubElementID="MatchCount">
          <Name>Match Count</Name>
          <Description>The number of consecutive samples that must occur before the monitor is unhealthy</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.ICMPPing.MonitorType" SubElementID="SyncTime">
          <Name>Sync Time</Name>
          <Description>Sync Time</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.PingStatus.Monitor">
          <Name>Ping Status</Name>
          <Description>Pings the target and sets health based on the response and the expected status</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.PingStatus.Monitor.AlertMessage">
          <Name>Unexpected Ping Status</Name>
          <Description>The ping result for {0} ({1}) is not {2}
</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.PingStatus.Monitor" SubElementID="Healthy">
          <Name>Healthy</Name>
          <Description>Healthy</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.PingStatus.Monitor" SubElementID="Warning">
          <Name>Warning</Name>
          <Description>Warning</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.PingStatus.Monitor" SubElementID="Critical">
          <Name>Critical</Name>
          <Description>Critical</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.Target.ResponseTimePerformanceCollection.Rule">
          <Name>ICMP Ping Response Time Performance Collection Rule</Name>
          <Description></Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.RemoveSimplePing.WriteAction">
          <Name>Remove Simple Ping </Name>
          <Description>Created Simple Ping</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.RemoveSimplePing.WriteAction" SubElementID="ManagementServer">
          <Name>Management Server</Name>
          <Description>Management Server to run the task on.</Description>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.Root.Folder">
          <Name>Simple Ping</Name>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.Resource.Pool.View">
          <Name>Resource Pool</Name>
        </DisplayString>
        <DisplayString ElementID="Simple.Ping.Target.View">
          <Name>Targets</Name>
        </DisplayString>
      </DisplayStrings>
      <KnowledgeArticles>
        <KnowledgeArticle ElementID="Simple.Ping" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>Simple Ping</maml:title>
              <maml:para>
                Documentation and the latest version can be found on GitHub -<maml:navigationLink><maml:linkText>https://github.com/KeithRochester/Simple-Ping.</maml:linkText><maml:uri href="https://github.com/KeithRochester/Simple-Ping" /></maml:navigationLink>. 
              </maml:para>
              <maml:para>
                If you have any questions or suggestions, please send me a message <maml:navigationLink><maml:linkText>keith.rochester@unit92.com</maml:linkText><maml:uri href="mailto:keith.rochester@unit92.com?subject=Standard%20Monitoring%20Framework" /></maml:navigationLink></maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
        <KnowledgeArticle ElementID="Simple.Ping.Target.ResponseTimePerformanceCollection.Rule" Visible="true">
          <MamlContent>
            <maml:section xmlns:maml="http://schemas.microsoft.com/maml/2004/10">
              <maml:title>ICMP Ping Response Time Performance Collection Rule</maml:title>
              <maml:para>
                <maml:ui>Description</maml:ui>
              </maml:para>
              <maml:para></maml:para>
              <maml:para>
                <maml:ui>Configuration</maml:ui>
              </maml:para>
              <maml:para>
                Enabled by default
              </maml:para>
              <maml:para>
                Documentation and the latest version can be found on GitHub -<maml:navigationLink><maml:linkText>https://github.com/KeithRochester/Simple-Ping.</maml:linkText><maml:uri href="https://github.com/KeithRochester/Simple-Ping" /></maml:navigationLink>. 
              </maml:para>
              <maml:para>
                If you have any questions or suggestions, please send me a message <maml:navigationLink><maml:linkText>keith.rochester@unit92.com</maml:linkText><maml:uri href="mailto:keith.rochester@unit92.com?subject=Standard%20Monitoring%20Framework" /></maml:navigationLink></maml:para>
            </maml:section>
          </MamlContent>
        </KnowledgeArticle>
      </KnowledgeArticles>
    </LanguagePack>
  </LanguagePacks>
</ManagementPack>